"use strict";var blogmine=blogmine||{};function blogmineDomReady(e){if("function"==typeof e){if("interactive"===document.readyState||"complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)}}blogmine.traverseMenu={init:function(){let e=document.querySelector(".blogmine-top-nav"),t=document.getElementById("site-navigation");e&&this.traverse(e),t&&this.traverse(t)},traverse:function(e){let t=e.getElementsByTagName("ul")[0];if(void 0!==t){t.classList.contains("nav-menu")||t.classList.add("nav-menu");let i=t.getElementsByTagName("a"),o=t.querySelectorAll(".menu-item-has-children > a, .page_item_has_children > a");for(let n of i)n.addEventListener("focus",this.toggleFocus,!0),n.addEventListener("blur",this.toggleFocus,!0);for(let l of o)l.addEventListener("touchstart",this.toggleFocus,!1)}},toggleFocus:function(e){if("focus"===e.type||"blur"===e.type){let t=this;for(;!t.classList.contains("nav-menu");)"li"===t.tagName.toLowerCase()&&t.classList.toggle("focus"),t=t.parentNode}if("touchstart"===e.type){let i=this.parentNode;for(let o of(e.preventDefault(),i.parentNode.children))i!==o&&o.classList.remove("focus");i.classList.toggle("focus")}}},blogmine.handleFocus={init:function(){this.keepFocusInModal()},keepFocusInModal:function(){let e=document.querySelectorAll(".blogmine-canvas-modal");document.addEventListener("keydown",function(t){("Tab"===t.key||9===t.keyCode)&&e&&e.forEach(function(e){let i=e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="search"]:not([disabled]), input[type="submit"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])'),o=i[0],n=i[i.length-1];t.shiftKey?document.activeElement===o&&(n.focus(),t.preventDefault()):document.activeElement===n&&(o.focus(),t.preventDefault())})})}},blogmine.fadeOutPreloader={init:function(){let e=document.querySelector("#blogmine-preloader-wrapper");e&&(e.classList.add("fadeOut"),setTimeout(function(){e.style.display="none"},1e3))}},blogmine.scrollToTop={init:function(){let e=document.documentElement,t=this,i=document.querySelectorAll(".blogmine-toggle-scroll-top");i&&i.forEach(function(i){t.goToTop(i,e)});let o=document.querySelectorAll(".blogmine-floating-scroll-top");o&&o.forEach(function(i){t.scrollToTopPosition(i,e)})},goToTop:function(e,t){e.addEventListener("click",function(e){e.preventDefault(),t.scrollTo({top:0,behavior:"smooth"})})},scrollToTopPosition:function(e,t){window.addEventListener("scroll",function(i){let o=t.scrollHeight-t.clientHeight;t.scrollTop/o>.4?e.classList.add("visible"):e.classList.remove("visible")})}},blogmine.stickyMenu={stickyPoint:"",init:function(){let e=this,t=document.querySelector(".blogmine-primary-bar-row.sticky-menu");t&&(e.stickyPoint=t.offsetTop,e.updateMenuHeight(t),window.addEventListener("resize",function(i){e.stickyPoint=t.offsetTop,e.updateMenuHeight(t)}),window.addEventListener("scroll",function(i){window.pageYOffset>e.stickyPoint?t.classList.add("has-menu-sticked"):t.classList.remove("has-menu-sticked")}))},updateMenuHeight:function(e){e.style.height="unset";let t=e.getBoundingClientRect().height;t>1?e.style.height=(t+.1).toFixed(2)+"px":e.style.height="unset"}},blogmine.subMenuToggle={init:function(){let e=document.querySelectorAll(".sub-menu-toggle");e&&e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("active"),this.setAttribute("aria-selected",`${"true"!==this.getAttribute("aria-selected")}`);let t=this.getAttribute("data-toggle-target");t&&document.querySelector(t).classList.toggle("active")})})}},blogmine.CanvasModal={init:function(){document.querySelector(".toggle-canvas-modal")&&(this.onOpen(),this.onClose(),this.outsideModal(),this.closeOnEscape())},onOpen:function(){document.querySelectorAll(".toggle-canvas-modal").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),document.body.classList.add("canvas-modal-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),e.classList.add("active"),e.setAttribute("aria-expanded",!0);let i=this.getAttribute("data-focus");i&&setTimeout(function(){document.querySelector(i).focus()},500)})})},onClose:function(){document.querySelectorAll(".close-canvas-modal").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),this.hideModal()}).bind(this))}).bind(this))},outsideModal:function(){document.addEventListener("click",(function(e){if(document.body.classList.contains("canvas-modal-is-open")){let t=document.querySelector("#page.site");e.target==t&&this.hideModal()}}).bind(this))},closeOnEscape:function(){document.addEventListener("keydown",(function(e){"Escape"===e.key&&(e.preventDefault(),this.hideModal())}).bind(this))},hideModal:function(){document.body.classList.remove("canvas-modal-is-open");let e=document.querySelector(".toggle-canvas-modal.active");if(e){document.body.classList.remove(e.getAttribute("data-body-class"));let t=e.getAttribute("data-focus");t&&document.querySelector(t).blur(),e.setAttribute("aria-expanded",!1),e.focus(),e.classList.remove("active")}}},blogmine.SearchBlock={isToggled:!1,init:function(){document.querySelector(".toggle-search-block")&&(this.toggleSearchBlock(),this.closeOnEscape())},toggleSearchBlock:function(){let e=this;document.querySelectorAll(".toggle-search-block").forEach(function(t){t.addEventListener("click",function(i){if(i.preventDefault(),e.isToggled=!e.isToggled,e.isToggled){document.body.classList.add("search-block-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),t.classList.add("active"),t.parentNode.classList.add("active"),t.setAttribute("aria-expanded",!0);let o=this.getAttribute("data-focus");o&&setTimeout(function(){t.parentNode.querySelector(o).focus()},500),setTimeout(function(){e.outsideBlock()},100)}else e.hideBlock()})})},closeOnEscape:function(){let e=this;document.addEventListener("keydown",function(t){"Escape"===t.key&&(t.preventDefault(),e.hideBlock())})},outsideBlock:function(){document.addEventListener("click",this.handleClickOutsideBox)},handleClickOutsideBox:function(e){document.body.classList.contains("search-block-is-open")&&(document.querySelector(".blogmine-search-toggle.active .em-search-form-inner").contains(e.target)||blogmine.SearchBlock.hideBlock())},hideBlock:function(){let e=this;document.body.classList.remove("search-block-is-open");let t=document.querySelector(".toggle-search-block.active");if(t){document.body.classList.remove(t.getAttribute("data-body-class"));let i=t.getAttribute("data-focus");i&&t.parentNode.querySelector(i).blur(),t.setAttribute("aria-expanded",!1),t.focus(),t.classList.remove("active"),t.parentNode.classList.remove("active"),document.removeEventListener("click",e.handleClickOutsideBox),e.isToggled=!1}}},blogmine.setBackgroundImage={init:function(){let e=document.querySelectorAll(".blogmine-bg-image");e&&e.forEach(function(e){let t=e.querySelector("img");if(t){let i=t.getAttribute("src");i&&(e.style.backgroundImage="url("+i+")",t.style.display="none")}})}},blogmine.progressBar={init:function(){let e=document.getElementById("blogmine-progress-bar");if(e){let t=document.body,i=document.documentElement;window.addEventListener("scroll",function(o){let n=t.scrollTop||i.scrollTop,l=i.scrollHeight-i.clientHeight;e.style.width=n/l*100+"%"})}}},blogmine.slider={init:function(){this.bannerSlider(),this.widgetSlider()},bannerSlider:function(){let e=document.querySelector(".blogmine-banner-wrapper");if(e){let t,i=e.getAttribute("data-banner")||{};i&&(t=JSON.parse(i));let o={loop:!0,...t};new Swiper(e,o)}},widgetSlider:function(){let e=document.querySelectorAll(".blogmine-slider-wrapper-block .swiper");e&&e.forEach(function(e){let t=e.parentNode,i=t.querySelector(".swiper-button-next"),o=t.querySelector(".swiper-button-prev"),n=t.querySelector(".swiper-pagination"),l=e.getAttribute("data-slider")||{};if(l)var s=JSON.parse(l);let a={slidesPerView:1,lazyloading:!0,navigation:{nextEl:i,prevEl:o},pagination:{el:n,clickable:!0},...s},c=new Swiper(e,a);e.clientWidth<500&&(c.params.slidesPerView=1,c.update())})}},blogmine.tabs={init:function(){let e=document.querySelectorAll("[data-toggle='uf-tab']");e&&e.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();let i=[...e.parentNode.children],o=[...e.parentNode.nextElementSibling.children,];i.forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")}),o.forEach(e=>{e.classList.remove("active")});let n=e.getAttribute("aria-controls"),l=document.getElementById(n);e.classList.add("active"),e.setAttribute("aria-selected","true"),l.classList.add("active")})})}},blogmineDomReady(function(){blogmine.stickyMenu.init(),blogmine.subMenuToggle.init(),blogmine.traverseMenu.init(),blogmine.handleFocus.init(),blogmine.CanvasModal.init(),blogmine.SearchBlock.init(),blogmine.scrollToTop.init(),blogmine.setBackgroundImage.init(),blogmine.progressBar.init(),blogmine.slider.init(),blogmine.tabs.init()}),window.addEventListener("load",function(e){blogmine.fadeOutPreloader.init()}),function(e){var t=t||{};let i,o,n,l,s,a=e(".blogmine-load-posts-btn-wrapper"),c=e(".blogmine-ajax-load-btn"),r=e(".blogmine-ajax-loader");a.length>0&&(o=(i=parseInt(a.attr("data-page")))+1,n=parseInt(a.attr("data-max-pages")),l=a.attr("data-load-type"),s=a.closest("#primary").attr("data-template"));let d=!0;function u(){e.ajax({type:"POST",url:BlogmineVars.ajaxurl,data:{action:"blogmine_load_posts",load_post_nonce:BlogmineVars.load_post_nonce,query_vars:BlogmineVars.query_vars,page:o,template:s},dataType:"json",beforeSend:function(){c.addClass("loading-posts"),r.addClass("active"),d=!1},success:function(s){if(s.success){let a=s.data.content.join(""),u=e(a);u.hide(),e(".blogmine-posts-lists").append(u),a.indexOf("blogmine-bg-image")>=0&&t.setBackgroundImage.init(),u.fadeIn(),i=o,++o<=n?"button_click_load"==l&&setTimeout(function(){r.removeClass("active"),c.removeClass("loading-posts")},500):c.fadeOut(),d=!0,e(document.body).trigger("posts-loaded")}else r.removeClass("active")}})}t.loadMorePosts={fetchPostsOnClick:function(){c.on("click",function(e){e.preventDefault(),d&&u()})},fetchPostsOnScroll:function(){let t=a.offset().top-e(window).scrollTop();o<=n&&700>t&&d&&u()}},e(document).ready(function(){a.length>0&&("button_click_load"==l&&t.loadMorePosts.fetchPostsOnClick(),"infinite_scroll_load"==l&&e(window).scroll(function(){t.loadMorePosts.fetchPostsOnScroll()}))})}(jQuery);